import{a as ee}from"./chunk-YVYKRIXK.js";import{a as Z}from"./chunk-KYJZKOBB.js";import{a as X}from"./chunk-7EIHC7WG.js";import{a as K}from"./chunk-2TM6U6BO.js";import{b as Y}from"./chunk-3SNT5TZL.js";import{b as q,d as G,g as H,s as J}from"./chunk-PCHI4UW3.js";import"./chunk-6VCTTBHM.js";import"./chunk-WBRTOA2C.js";import{f as O,h as U,m as W}from"./chunk-LPDC563P.js";import{$ as P,A as I,Ab as R,Cb as L,Db as M,Fb as N,N as h,Na as s,Oa as C,Za as u,ab as A,cb as k,db as $,eb as c,f as j,gb as V,ha as m,hb as S,ia as p,ib as b,jb as n,k as T,kb as i,lb as f,mb as v,mc as z,nb as x,o as w,ob as d,ub as o,vb as _,wb as y,xb as F,yb as Q,zb as B}from"./chunk-URYE4ZYK.js";import"./chunk-X5YLR3NI.js";import{a as D,b as E}from"./chunk-ODN5LVDJ.js";var te=(t,l)=>l.id,ne=()=>[1,2,3,4],ae=()=>[1,2,3],re=(t,l)=>({name:t,location:l});function oe(t,l){t&1&&f(0,"div",6)}function se(t,l){if(t&1&&(n(0,"div")(1,"div",11),f(2,"div",12),n(3,"h1",13),o(4),i()(),n(5,"p",14),o(6),i()()),t&2){let e=d();s(2),$("w-2.5 h-2.5 rounded-full "+e.getStatusColor(e.area.status)),A("title",e.area.status==="active"?"Active":"Inactive"),s(2),_(e.area.name),s(2),_(e.area.location)}}function le(t,l){if(t&1){let e=v();n(0,"div",7)(1,"button",15),x("click",function(){m(e);let r=d();return p(r.refreshData())}),n(2,"span",5),o(3,"refresh"),i()(),n(4,"button",16),x("click",function(){m(e);let r=d();return p(r.toggleAreaStatus())}),n(5,"span",17),o(6),i(),o(7),i(),n(8,"button",18),x("click",function(){m(e);let r=d();return p(r.openAddScreenDialog())}),n(9,"span",17),o(10,"add_circle"),i(),o(11," Add Screen "),i()()}if(t&2){let e=d();s(4),k("bg-red-50",e.area.status==="active")("text-red-600",e.area.status==="active")("bg-green-50",e.area.status==="inactive")("text-green-600",e.area.status==="inactive"),s(2),y(" ",e.area.status==="active"?"pause_circle":"play_circle"," "),s(),y(" ",e.area.status==="active"?"Deactivate Area":"Activate Area"," ")}}function de(t,l){if(t&1){let e=v();n(0,"div",8)(1,"div",19)(2,"div",20)(3,"span",21),o(4,"error"),i(),o(5),i(),n(6,"button",22),x("click",function(){m(e);let r=d();return p(r.error=null)}),n(7,"span",5),o(8,"close"),i()()()()}if(t&2){let e=d();s(5),y(" ",e.error," ")}}function ce(t,l){t&1&&(n(0,"div",24)(1,"div",3),f(2,"div",29),n(3,"div",30),f(4,"div",31)(5,"div",32),i()()())}function me(t,l){t&1&&f(0,"div",28)}function pe(t,l){t&1&&(n(0,"div",9)(1,"div",23),S(2,ce,6,0,"div",24,V),i(),n(4,"div",25),f(5,"div",26),n(6,"div",27),S(7,me,1,0,"div",28,V),i()()()),t&2&&(s(2),b(M(0,ne)),s(5),b(M(1,ae)))}function ue(t,l){if(t&1&&(n(0,"div",8)(1,"div",56)(2,"h2",57),o(3,"Description"),i(),n(4,"p",58),o(5),i()()()),t&2){let e=d(2);s(5),_(e.area.description)}}function _e(t,l){if(t&1&&(n(0,"p",65),o(1),i()),t&2){let e=d().$implicit;s(),_(e.description)}}function xe(t,l){if(t&1&&(n(0,"div",60)(1,"div",61)(2,"div")(3,"h3",62),o(4),i(),n(5,"p",14),o(6),i()(),n(7,"div",63)(8,"span",64),o(9),i()()(),u(10,_e,2,1,"p",65),i()),t&2){let e=l.$implicit;s(4),_(e.name),s(2),F("",e.items.length," items \u2022 ",e.duration," sec"),s(2),k("bg-emerald-100",e.status==="active")("text-emerald-800",e.status==="active")("bg-amber-100",e.status==="draft")("text-amber-800",e.status==="draft")("bg-gray-100",e.status==="archived")("text-gray-800",e.status==="archived"),s(),y(" ",e.status," "),s(),c(e.description?10:-1)}}function ge(t,l){if(t&1&&(n(0,"div",8)(1,"div",56)(2,"h2",59),o(3,"Assigned Playlists"),i(),n(4,"div",27),S(5,xe,11,17,"div",60,te),i()()()),t&2){let e=d(2);s(5),b(e.playlists)}}function he(t,l){if(t&1){let e=v();n(0,"button",66),x("click",function(){m(e);let r=d(2);return p(r.searchQuery="")}),o(1," Clear search "),i()}}function fe(t,l){t&1&&o(0," No screens found ")}function ve(t,l){t&1&&o(0," No screens match your search ")}function Ce(t,l){t&1&&o(0," Add screens to this area to get started ")}function Se(t,l){t&1&&o(0," Try adjusting your search criteria ")}function be(t,l){if(t&1&&(n(0,"div",54)(1,"span",67),o(2,"monitor"),i(),n(3,"h3",68),u(4,fe,1,0)(5,ve,1,0),i(),n(6,"p",69),u(7,Ce,1,0)(8,Se,1,0),i()()),t&2){let e=d(2);s(4),c(e.screens.length===0?4:5),s(3),c(e.screens.length===0?7:8)}}function ye(t,l){if(t&1){let e=v();n(0,"app-screen-card",71),x("edit",function(r){m(e);let g=d(3);return p(g.editScreen(r))}),i()}if(t&2){let e=l.$implicit;A("screen",e)}}function we(t,l){if(t&1&&(n(0,"div",55),S(1,ye,1,1,"app-screen-card",70,te),i()),t&2){let e=d(2);s(),b(e.filteredScreens)}}function Ae(t,l){if(t&1){let e=v();n(0,"div",33)(1,"div",34)(2,"div",3)(3,"div",35)(4,"span",36),o(5,"devices"),i()(),n(6,"div")(7,"p",37),o(8,"Total Screens"),i(),n(9,"p",38),o(10),i()()()(),n(11,"div",34)(12,"div",3)(13,"div",39)(14,"span",40),o(15,"wifi"),i()(),n(16,"div")(17,"p",37),o(18,"Online"),i(),n(19,"p",38),o(20),i()()()(),n(21,"div",34)(22,"div",3)(23,"div",41)(24,"span",42),o(25,"wifi_off"),i()(),n(26,"div")(27,"p",37),o(28,"Offline"),i(),n(29,"p",38),o(30),i()()()(),n(31,"div",34)(32,"div",3)(33,"div",43)(34,"span",44),o(35,"build"),i()(),n(36,"div")(37,"p",37),o(38,"Maintenance"),i(),n(39,"p",38),o(40),i()()()()(),u(41,ue,6,1,"div",8)(42,ge,7,0,"div",8),n(43,"div",8)(44,"div",45)(45,"div",46)(46,"div",47)(47,"input",48),R("ngModelChange",function(r){m(e);let g=d();return B(g.searchQuery,r)||(g.searchQuery=r),p(r)}),i(),n(48,"span",49),o(49,"search"),i()(),n(50,"div",37),o(51),i()()()(),n(52,"div",50)(53,"div",51)(54,"h2",52),o(55,"Screens"),i(),u(56,he,2,0,"button",53),i(),u(57,be,9,2,"div",54)(58,we,3,0,"div",55),i()}if(t&2){let e=d();s(10),_(e.stats.total),s(10),_(e.stats.online),s(10),_(e.stats.offline),s(10),_(e.stats.maintenance),s(),c(e.area.description?41:-1),s(),c(e.playlists.length>0?42:-1),s(5),Q("ngModel",e.searchQuery),s(4),F(" Showing ",e.filteredScreens.length," of ",e.screens.length," screens "),s(5),c(e.screens.length>0&&e.filteredScreens.length===0?56:-1),s(),c(e.filteredScreens.length===0?57:58)}}function De(t,l){if(t&1){let e=v();n(0,"app-area-screens-dialog",72),x("createArea",function(){m(e);let r=d();return p(r.closeAddScreenDialog(!0))})("back",function(){m(e);let r=d();return p(r.closeAddScreenDialog(!1))}),i()}if(t&2){let e=d();A("areaData",N(2,re,(e.area==null?null:e.area.name)||"",(e.area==null?null:e.area.location)||""))("availableScreens",e.screens)}}var Le=(()=>{class t{constructor(e,a,r,g,ie){this.route=e,this.router=a,this.areaService=r,this.screenService=g,this.playlistService=ie,this.area=null,this.screens=[],this.playlists=[],this.loading=!0,this.error=null,this.showAddScreenDialog=!1,this.searchQuery="",this.stats={online:0,offline:0,maintenance:0,error:0,total:0},this.areaId=null,this.realtimeChannel=null,this.destroy$=new j}ngOnInit(){this.initializeData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.realtimeChannel&&this.areaService.unsubscribeFromUpdates(this.realtimeChannel)}initializeData(){this.loading=!0,this.error=null,this.route.paramMap.pipe(h(this.destroy$),w(a=>a.get("id"))).subscribe(a=>{if(!a){this.error="No area ID provided",this.loading=!1;return}this.areaId=a,this.areaService.getAreaById(a).pipe(I(r=>(console.error("Error loading area:",r),this.error="Failed to load area details. Please try again.",T(null)))).subscribe(r=>{this.area=r,r?(this.loadScreens(a),this.loadPlaylists(a),this.setupRealtimeSubscription()):this.error||(this.error="Area not found"),this.loading=!1})})}loadScreens(e){this.screenService.getScreens().pipe(w(a=>a.filter(r=>r.area_id===e)),h(this.destroy$)).subscribe(a=>{this.screens=a,this.updateStats()})}loadPlaylists(e){this.playlistService.getPlaylists().pipe(h(this.destroy$)).subscribe(a=>{this.playlists=a})}setupRealtimeSubscription(){this.areaId&&(this.realtimeChannel=this.areaService.subscribeToUpdates(e=>{e.id===this.areaId&&(console.log("Area update received:",e),this.area=e,this.refreshScreens())}))}refreshScreens(){this.areaId&&this.screenService.getScreens().pipe(w(e=>e.filter(a=>a.area_id===this.areaId)),h(this.destroy$)).subscribe(e=>{this.screens=e,this.updateStats()})}updateStats(){this.stats={online:this.screens.filter(e=>e.status==="online").length,offline:this.screens.filter(e=>e.status==="offline").length,maintenance:this.screens.filter(e=>e.status==="maintenance").length,error:this.screens.filter(e=>e.status==="error").length,total:this.screens.length}}toggleAreaStatus(){if(!this.area)return;let e=this.area.status==="active"?"inactive":"active",a=this.area.status;this.area=E(D({},this.area),{status:e}),this.areaService.updateArea(this.area.id,{status:e}).pipe(h(this.destroy$)).subscribe({next:r=>{this.area=r},error:r=>{console.error("Error updating area status:",r),this.area&&(this.area=E(D({},this.area),{status:a})),this.error="Failed to update area status. Please try again."}})}refreshData(){this.initializeData()}openAddScreenDialog(){this.showAddScreenDialog=!0}closeAddScreenDialog(e=!1){this.showAddScreenDialog=!1,e&&this.refreshData()}editScreen(e){this.router.navigate(["/screens",e.id])}getStatusColor(e){return e==="active"?"bg-green-500":"bg-gray-400"}getScreenStatusCount(e){return this.screens.filter(a=>a.status===e).length}goBack(){this.router.navigate(["/areas"])}get filteredScreens(){if(!this.searchQuery.trim())return this.screens;let e=this.searchQuery.toLowerCase();return this.screens.filter(a=>a.name.toLowerCase().includes(e)||a.status.toLowerCase().includes(e)||a.tags&&a.tags.some(r=>r.toLowerCase().includes(e)))}addScreenToArea(e){this.areaId&&this.screenService.updateScreen(e,{area_id:this.areaId}).pipe(h(this.destroy$),I(a=>(console.error("Error adding screen to area:",a),this.error="Failed to add screen to area. Please try again.",T(null)))).subscribe(a=>{a&&(this.screens.some(r=>r.id===a.id)||(this.screens=[...this.screens,a],this.updateStats()))})}static{this.\u0275fac=function(a){return new(a||t)(C(O),C(U),C(K),C(Y),C(Z))}}static{this.\u0275cmp=P({type:t,selectors:[["app-area-details"]],standalone:!0,features:[L],decls:14,vars:6,consts:[[1,"min-h-screen","bg-gray-50"],[1,"max-w-7xl","mx-auto","bg-white","rounded-xl","shadow-sm","p-6","mb-6"],[1,"flex","justify-between","items-center"],[1,"flex","items-center","gap-4"],[1,"p-2","text-gray-500","hover:text-gray-700","hover:bg-gray-100","rounded-full","transition-colors",3,"click"],[1,"material-icons"],[1,"h-8","w-48","bg-gray-200","animate-pulse","rounded"],[1,"flex","gap-3"],[1,"max-w-7xl","mx-auto","mb-6"],[1,"max-w-7xl","mx-auto"],[3,"areaData","availableScreens"],[1,"flex","items-center","gap-2"],[3,"title"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"text-sm","text-gray-500","mt-1"],["title","Refresh data",1,"p-2","text-gray-500","hover:text-gray-700","hover:bg-gray-100","rounded-full","transition-colors",3,"click"],[1,"px-4","py-2","rounded-lg","text-sm","font-medium","flex","items-center","gap-2","transition-colors",3,"click"],[1,"material-icons","text-sm"],[1,"px-4","py-2","bg-blue-50","text-blue-600","rounded-lg","hover:bg-blue-100","transition-colors","text-sm","font-medium","flex","items-center","gap-2",3,"click"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-4","flex","items-center","justify-between","text-red-700"],[1,"flex","items-center"],[1,"material-icons","mr-2"],[1,"text-red-500","hover:text-red-700",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-6"],[1,"bg-white","rounded-xl","p-6","shadow-sm","animate-pulse"],[1,"bg-white","rounded-xl","p-6","mb-6"],[1,"h-6","w-32","bg-gray-200","rounded","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"bg-gray-100","rounded-lg","h-40","animate-pulse"],[1,"w-12","h-12","rounded-lg","bg-gray-200"],[1,"space-y-2"],[1,"h-4","w-24","bg-gray-200","rounded"],[1,"h-6","w-12","bg-gray-300","rounded"],[1,"max-w-7xl","mx-auto","grid","grid-cols-1","md:grid-cols-4","gap-4","mb-6"],[1,"bg-white","rounded-xl","p-6","shadow-sm","hover:shadow-md","transition-shadow"],[1,"p-3","bg-blue-50","rounded-lg"],[1,"material-icons","text-blue-600"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold"],[1,"p-3","bg-green-50","rounded-lg"],[1,"material-icons","text-green-600"],[1,"p-3","bg-gray-50","rounded-lg"],[1,"material-icons","text-gray-600"],[1,"p-3","bg-amber-50","rounded-lg"],[1,"material-icons","text-amber-600"],[1,"bg-white","rounded-xl","p-4","shadow-sm"],[1,"flex","flex-col","sm:flex-row","items-center","gap-4"],[1,"relative","flex-grow"],["type","text","placeholder","Search screens...",1,"w-full","pl-10","pr-4","py-2","border","border-gray-200","rounded-lg","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-100","focus:border-blue-200","transition-colors",3,"ngModelChange","ngModel"],[1,"material-icons","absolute","left-3","top-2.5","text-gray-400","text-sm"],[1,"max-w-7xl","mx-auto","px-4","py-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-medium","text-gray-900"],[1,"text-blue-600","hover:text-blue-800","text-sm","font-medium"],[1,"bg-white","rounded-xl","p-8","text-center"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"bg-white","rounded-xl","p-6","shadow-sm"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"text-lg","font-medium","text-gray-900","mb-4"],[1,"border","border-gray-100","rounded-lg","p-4","hover:shadow-md","transition-shadow"],[1,"flex","justify-between","items-start"],[1,"font-medium","text-gray-800"],[1,"flex","items-center","gap-1"],[1,"px-2","py-1","rounded-full","text-xs","font-medium","capitalize"],[1,"text-sm","text-gray-600","mt-2","line-clamp-2"],[1,"text-blue-600","hover:text-blue-800","text-sm","font-medium",3,"click"],[1,"material-icons","text-4xl","text-gray-400","mb-2"],[1,"text-lg","font-medium","text-gray-900","mb-1"],[1,"text-gray-500"],[3,"screen"],[3,"edit","screen"],[3,"createArea","back","areaData","availableScreens"]],template:function(a,r){a&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),x("click",function(){return r.goBack()}),n(5,"span",5),o(6,"arrow_back"),i()(),u(7,oe,1,0,"div",6)(8,se,7,5,"div"),i(),u(9,le,12,10,"div",7),i()(),u(10,de,9,1,"div",8)(11,pe,9,2,"div",9)(12,Ae,59,11)(13,De,1,5,"app-area-screens-dialog",10),i()),a&2&&(s(7),c(r.loading?7:r.area?8:-1),s(2),c(r.area?9:-1),s(),c(r.error?10:-1),s(),c(r.loading?11:-1),s(),c(!r.loading&&r.area?12:-1),s(),c(r.showAddScreenDialog?13:-1))},dependencies:[z,W,J,q,G,H,X,ee],encapsulation:2})}}return t})();export{Le as AreaDetailsComponent};
