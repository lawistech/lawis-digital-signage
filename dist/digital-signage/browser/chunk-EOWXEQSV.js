import{d as z}from"./chunk-LPDC563P.js";import{$ as C,Cb as j,Ha as h,Ia as P,Na as o,Oa as b,Za as g,ab as d,bb as k,cb as _,db as v,eb as p,ha as x,ia as w,jb as l,kb as r,lb as c,mb as T,mc as O,na as I,nb as f,ob as s,qb as D,rb as S,sb as E,ub as u,vb as y,xb as M}from"./chunk-URYE4ZYK.js";var V=["videoPlayer"];function Q(i,a){if(i&1&&c(0,"img",15),i&2){let t=s(2);v(t.getScalingClass(t.currentItem.settings.scaling)),_("fade-in",t.isTransitioning),d("src",t.currentItem.content.url,h)("alt",t.currentItem.name)}}function R(i,a){if(i&1){let t=T();l(0,"video",16,0),f("ended",function(){x(t);let e=s(2);return w(e.onVideoEnded())}),r()}if(i&2){let t,n,e=s(2);v(e.getScalingClass(e.currentItem.settings.scaling)),d("src",e.currentItem.content.url,h)("muted",(t=e.currentItem.settings.muted)!==null&&t!==void 0?t:!0)("loop",(n=e.currentItem.settings.loop)!==null&&n!==void 0?n:!1)}}function B(i,a){if(i&1&&c(0,"iframe",13),i&2){let t=s(2);d("src",t.getSafeUrl(t.currentItem.content.url),P)}}function F(i,a){if(i&1&&(l(0,"div",14)(1,"div",17),u(2),r()()),i&2){let t=s(2);o(2),y(t.currentItem.content.url)}}function q(i,a){if(i&1&&g(0,Q,1,6,"img",11)(1,R,2,5,"video",12)(2,B,1,1,"iframe",13)(3,F,3,1,"div",14),i&2){let t,n=s();p((t=n.currentItem.type)==="image"?0:t==="video"?1:t==="webpage"?2:t==="ticker"?3:-1)}}function A(i,a){if(i&1&&c(0,"div",18),i&2){let t=s();_("opacity-0",!t.isTransitioning)("opacity-100",t.isTransitioning)}}var Y=(()=>{class i{constructor(t){this.sanitizer=t,this.closeDialog=new I,this.currentIndex=0,this.currentItem=null,this.progress=0,this.isTransitioning=!1,this.timer=null}ngOnInit(){this.playlist.items.length>0?this.startPlayback():this.close()}ngOnDestroy(){this.clearTimer()}startPlayback(){this.currentItem=this.playlist.items[this.currentIndex],this.progress=0,this.isTransitioning=!0,setTimeout(()=>{if(this.isTransitioning=!1,this.currentItem?.type==="video"&&this.videoPlayer)this.videoPlayer.nativeElement.play().catch(console.error);else if(this.currentItem){let t=this.currentItem.duration||this.playlist.settings.defaultDuration;this.startTimer(t*1e3)}},this.currentItem?.settings.transitionDuration||500)}startTimer(t){let n=Date.now();this.timer=setInterval(()=>{let e=Date.now()-n;this.progress=e/t*100,e>=t&&this.nextItem()},100)}nextItem(){if(this.clearTimer(),this.currentIndex=(this.currentIndex+1)%this.playlist.items.length,this.currentIndex===0&&!this.playlist.settings.loop){this.close();return}this.startPlayback()}onVideoEnded(){this.currentItem&&!this.currentItem.settings.loop&&this.nextItem()}clearTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)}close(){this.clearTimer(),this.videoPlayer?.nativeElement&&this.videoPlayer.nativeElement.pause(),this.closeDialog.emit()}getScalingClass(t){switch(t){case"fill":return"w-full h-full object-cover";case"stretch":return"w-full h-full object-fill";default:return"w-full h-full object-contain"}}getSafeUrl(t){return this.sanitizer.bypassSecurityTrustResourceUrl(t)}handleBackdropClick(t){t.target===t.currentTarget&&this.close()}static{this.\u0275fac=function(n){return new(n||i)(b(z))}}static{this.\u0275cmp=C({type:i,selectors:[["app-playlist-preview-dialog"]],viewQuery:function(n,e){if(n&1&&D(V,5),n&2){let m;S(m=E())&&(e.videoPlayer=m.first)}},inputs:{playlist:"playlist"},outputs:{closeDialog:"closeDialog"},standalone:!0,features:[j],decls:16,vars:7,consts:[["videoPlayer",""],[1,"fixed","inset-0","bg-black/80","backdrop-blur-sm","flex","items-center","justify-center","z-50",3,"click"],[1,"relative","w-full","max-w-4xl","bg-black","rounded-lg","overflow-hidden"],[1,"absolute","top-4","right-4","z-10","p-2","text-white/70","hover:text-white","bg-black/50","rounded-full",3,"click"],[1,"material-icons"],[1,"aspect-video","relative"],[1,"absolute","inset-0","bg-black","transition-opacity","duration-500",3,"opacity-0","opacity-100"],[1,"absolute","bottom-0","left-0","right-0","bg-black/50","p-4"],[1,"flex","items-center","justify-between","text-white/70","text-sm","mb-2"],[1,"h-1","bg-white/20","rounded-full","overflow-hidden"],[1,"h-full","bg-blue-500","transition-all","duration-100"],[3,"src","alt","class","fade-in"],[1,"w-full","h-full","object-contain",3,"src","muted","loop","class"],[1,"w-full","h-full","border-0",3,"src"],[1,"w-full","h-full","flex","items-center","justify-center","text-white"],[3,"src","alt"],[1,"w-full","h-full","object-contain",3,"ended","src","muted","loop"],[1,"ticker-content"],[1,"absolute","inset-0","bg-black","transition-opacity","duration-500"]],template:function(n,e){n&1&&(l(0,"div",1),f("click",function(U){return e.handleBackdropClick(U)}),l(1,"div",2)(2,"button",3),f("click",function(){return e.close()}),l(3,"span",4),u(4,"close"),r()(),l(5,"div",5),g(6,q,4,1)(7,A,1,4,"div",6),r(),l(8,"div",7)(9,"div",8)(10,"span"),u(11),r(),l(12,"span"),u(13),r()(),l(14,"div",9),c(15,"div",10),r()()()()),n&2&&(o(6),p(e.currentItem?6:-1),o(),p((e.currentItem==null||e.currentItem.settings==null?null:e.currentItem.settings.transition)!=="none"?7:-1),o(4),y(e.currentItem==null?null:e.currentItem.name),o(2),M("",e.currentIndex+1," / ",e.playlist.items.length,""),o(2),k("width",e.progress,"%"))},dependencies:[O],styles:[".fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.ticker-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_tickerScroll 20s linear infinite}@keyframes _ngcontent-%COMP%_tickerScroll{0%{transform:translate(100%)}to{transform:translate(-100%)}}"]})}}return i})();export{Y as a};
