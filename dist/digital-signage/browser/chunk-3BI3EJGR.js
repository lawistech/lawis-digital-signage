import{a as ae}from"./chunk-YVYKRIXK.js";import"./chunk-KYJZKOBB.js";import{a as ne}from"./chunk-2TM6U6BO.js";import{a as ie,b as re}from"./chunk-3SNT5TZL.js";import{b as N,c as k,d as O,e as Q,g as H,h as J,j as K,k as X,l as B,m as L,n as j,q as Y,r as Z,s as ee,t as te}from"./chunk-PCHI4UW3.js";import"./chunk-6VCTTBHM.js";import{a as R}from"./chunk-WBRTOA2C.js";import{h as z}from"./chunk-LPDC563P.js";import{$ as E,Ab as V,Cb as M,Fb as G,Gb as q,Na as l,Oa as w,Za as f,ab as x,db as U,eb as u,fb as $,ha as g,hb as b,hc as A,ia as _,ib as y,jb as n,kb as t,lb as v,mb as h,mc as T,na as D,nb as p,ob as d,ub as a,vb as S,wb as C,xb as W,yb as F,zb as I}from"./chunk-URYE4ZYK.js";import"./chunk-X5YLR3NI.js";import{i as P}from"./chunk-ODN5LVDJ.js";var de=(r,s)=>s.id;function me(r,s){if(r&1){let e=h();n(0,"tr")(1,"td",6)(2,"span",7),v(3,"span",8),a(4),t()(),n(5,"td",6),a(6),t(),n(7,"td",6),a(8),t(),n(9,"td",6),a(10),t(),n(11,"td",6),a(12),t(),n(13,"td",6),a(14),t(),n(15,"td",9)(16,"button",10),p("click",function(){let i=g(e).$implicit,c=d();return _(c.edit.emit(i))}),a(17," Edit "),t(),n(18,"button",11),p("click",function(){let i=g(e).$implicit,c=d();return _(c.delete.emit(i.id))}),a(19," Delete "),t()()()}if(r&2){let e=s.$implicit;l(3),U(e.status==="online"?"bg-green-400":"bg-gray-400"),l(),C(" ",e.status," "),l(2),S(e.name),l(2),C(" ",e.channel_name," "),l(2),S(e.resolution),l(2),C(" ",e.channel_name||"None"," "),l(2),S(e.channel_name)}}var le=(()=>{class r{constructor(){this.screens=[],this.edit=new D,this.delete=new D}static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275cmp=E({type:r,selectors:[["app-screen-table"]],inputs:{screens:"screens"},outputs:{edit:"edit",delete:"delete"},standalone:!0,features:[M],decls:21,vars:0,consts:[[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"px-6","py-3","text-right","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[1,"px-6","py-4","whitespace-nowrap"],[1,"flex","items-center"],[1,"h-2.5","w-2.5","rounded-full","mr-2"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"text-indigo-600","hover:text-indigo-900","mr-4",3,"click"],[1,"text-red-600","hover:text-red-900",3,"click"]],template:function(o,i){o&1&&(n(0,"div",0)(1,"table",1)(2,"thead",2)(3,"tr")(4,"th",3),a(5," Status "),t(),n(6,"th",3),a(7," Name "),t(),n(8,"th",3),a(9," Channel "),t(),n(10,"th",3),a(11," Resolution "),t(),n(12,"th",3),a(13," Current Playlist "),t(),n(14,"th",3),a(15," Last Ping "),t(),n(16,"th",4),a(17," Actions "),t()()(),n(18,"tbody",5),b(19,me,20,8,"tr",null,de),t()()()),o&2&&(l(19),y(i.screens))},dependencies:[T],encapsulation:2})}}return r})();var ge=(r,s)=>s.id,_e=(r,s,e)=>({"bg-green-500 text-white":r,"bg-blue-500 text-white":s,"bg-gray-100 text-gray-400":e}),xe=(r,s)=>({"bg-green-500":r,"bg-gray-200":s});function fe(r,s){r&1&&(n(0,"span",14),a(1,"check"),t())}function Se(r,s){if(r&1&&a(0),r&2){let e=d().$index;C(" ",e+1," ")}}function Ce(r,s){if(r&1&&v(0,"div",15),r&2){let e=d().$index,o=d();x("ngClass",G(1,xe,e<o.currentStep,e>=o.currentStep))}}function he(r,s){if(r&1&&(n(0,"div",8)(1,"div",12)(2,"div",13),f(3,fe,2,0,"span",14)(4,Se,1,1),t(),f(5,Ce,1,4,"div",15),t(),n(6,"p",16),a(7),t()()),r&2){let e=s.$implicit,o=s.$index,i=d();l(2),x("ngClass",q(4,_e,o<i.currentStep,o===i.currentStep,o>i.currentStep)),l(),u(o<i.currentStep?3:4),l(2),u(o<i.steps.length-1?5:-1),l(2),S(e.description)}}function ve(r,s){r&1&&(n(0,"p",23),a(1,"Please enter a valid 6-digit code"),t())}function be(r,s){if(r&1&&(n(0,"div",24),a(1),t()),r&2){let e=d(2);l(),C(" ",e.errorMessage," ")}}function ye(r,s){r&1&&(n(0,"span",26)(1,"span",27),a(2,"refresh"),t(),a(3," Verifying... "),t())}function we(r,s){r&1&&a(0," Continue ")}function Ee(r,s){if(r&1){let e=h();n(0,"div",10)(1,"div",17)(2,"div",18)(3,"span",19),a(4,"tv"),t()(),n(5,"p",20),a(6,"Enter the 6-digit code displayed on your screen"),t()(),n(7,"form",21),p("ngSubmit",function(){g(e);let i=d();return _(i.verifyCode())}),v(8,"input",22),f(9,ve,2,0,"p",23)(10,be,2,1,"div",24),n(11,"button",25),f(12,ye,4,0,"span",26)(13,we,1,0),t()()()}if(r&2){let e=d();l(7),x("formGroup",e.codeForm),l(),x("ngClass",e.getInputClass(e.codeForm,"code")),l(),u(e.shouldShowError(e.codeForm,"code")?9:-1),l(),u(e.errorMessage?10:-1),l(),x("disabled",!e.codeForm.valid||e.isVerifying),l(),u(e.isVerifying?12:13)}}function De(r,s){r&1&&(n(0,"p",31),a(1,"Screen name is required"),t())}function Me(r,s){r&1&&v(0,"div",32)}function Te(r,s){if(r&1){let e=h();n(0,"div",33)(1,"select",40)(2,"option",41),a(3,"Failed to load areas"),t()(),n(4,"p",42)(5,"span",43),a(6,"error"),t(),a(7),t(),n(8,"button",44),p("click",function(){g(e);let i=d(2);return _(i.retryLoadAreas())}),n(9,"span",43),a(10,"refresh"),t(),a(11," Retry loading areas "),t()()}if(r&2){let e=d(2);l(7),C(" ",e.errorMessage," ")}}function ke(r,s){r&1&&(n(0,"div",33)(1,"select",45)(2,"option",41),a(3,"No areas available"),t()(),n(4,"p",46),a(5," Please create an area first before adding screens. "),t()())}function Fe(r,s){if(r&1&&(n(0,"option",48),a(1),t()),r&2){let e=s.$implicit;x("value",e.id),l(),W("",e.name," (",e.location,")")}}function Ie(r,s){r&1&&(n(0,"p",31),a(1,"Please select an area"),t())}function Ve(r,s){if(r&1&&(n(0,"select",47)(1,"option",41),a(2,"Select area"),t(),b(3,Fe,2,3,"option",48,ge),t(),f(5,Ie,2,0,"p",31)),r&2){let e=d(2);x("ngClass",e.getInputClass(e.screenForm,"area_id")),l(3),y(e.areas),l(2),u(e.shouldShowError(e.screenForm,"area_id")?5:-1)}}function Ae(r,s){if(r&1){let e=h();n(0,"div",11)(1,"form",28)(2,"div")(3,"label",29),a(4,"Screen Name"),t(),v(5,"input",30),f(6,De,2,0,"p",31),t(),n(7,"div")(8,"label",29),a(9,"Area"),t(),f(10,Me,1,0,"div",32)(11,Te,12,1,"div",33)(12,ke,6,0,"div",33)(13,Ve,6,2),t(),n(14,"div")(15,"label",29),a(16,"Orientation"),t(),n(17,"select",34)(18,"option",35),a(19,"Landscape"),t(),n(20,"option",36),a(21,"Portrait"),t()()()(),n(22,"div",37)(23,"button",38),p("click",function(){g(e);let i=d();return _(i.currentStep=0)}),a(24," Back "),t(),n(25,"button",39),p("click",function(){g(e);let i=d();return _(i.goToReview())}),a(26," Continue "),t()()()}if(r&2){let e=d();l(),x("formGroup",e.screenForm),l(5),u(e.shouldShowError(e.screenForm,"name")?6:-1),l(4),u(e.isLoading?10:e.errorMessage?11:e.areas.length===0?12:13),l(15),x("disabled",!e.screenForm.valid)}}function Ne(r,s){if(r&1&&(n(0,"div",53),a(1),t()),r&2){let e=d(2);l(),C(" ",e.errorMessage," ")}}function Oe(r,s){if(r&1){let e=h();n(0,"div",11)(1,"div",49)(2,"h3",50),a(3,"Review Configuration"),t(),n(4,"dl",51)(5,"div")(6,"dt",46),a(7,"Screen Name"),t(),n(8,"dd",52),a(9),t()(),n(10,"div")(11,"dt",46),a(12,"Area"),t(),n(13,"dd",52),a(14),t()(),n(15,"div")(16,"dt",46),a(17,"Orientation"),t(),n(18,"dd",52),a(19),t()(),n(20,"div")(21,"dt",46),a(22,"Resolution"),t(),n(23,"dd",52),a(24),t()()()(),f(25,Ne,2,1,"div",53),n(26,"div",54)(27,"button",38),p("click",function(){g(e);let i=d();return _(i.currentStep=1)}),a(28," Back "),t(),n(29,"button",55),p("click",function(){g(e);let i=d();return _(i.handleSubmit())}),a(30," Create Screen "),t()()()}if(r&2){let e=d();l(9),S(e.screenForm.value.name),l(5),C(" ",e.getAreaName(e.screenForm.value.area_id)," "),l(5),C(" ",e.screenForm.value.orientation.charAt(0).toUpperCase()+e.screenForm.value.orientation.slice(1)," "),l(5),C(" ",(e.detectedDevice==null?null:e.detectedDevice.resolution)||"1920x1080"," "),l(),u(e.errorMessage?25:-1)}}var se=(()=>{class r{constructor(e,o,i){this.fb=e,this.areaService=o,this.supabaseScreenService=i,this.onCreate=new D,this.onCancel=new D,this.currentStep=0,this.isVerifying=!1,this.isLoading=!0,this.areas=[],this.errorMessage=null,this.detectedDevice=null,this.steps=[{title:"Connect Device",description:"Enter the code shown on your screen"},{title:"Device Details",description:"Configure your screen settings"},{title:"Confirmation",description:"Review and complete setup"}],this.initializeForms()}ngOnInit(){this.loadAreas()}initializeForms(){this.codeForm=this.fb.group({code:["",[k.required,k.pattern("^[0-9]{6}$")]]}),this.screenForm=this.fb.group({name:["",[k.required]],area_id:["",[k.required]],orientation:["landscape",[k.required]]})}loadAreas(){if(this.isLoading=!0,this.errorMessage=null,this.shouldUseMockData()){this.provideMockAreas();return}this.areaService.getAreas().subscribe({next:e=>{console.log("Areas loaded successfully:",e),this.areas=e,e.length===0&&this.provideMockAreas(),this.isLoading=!1},error:e=>{console.error("Error loading areas:",e),this.errorMessage="Failed to load areas. Please try again.",this.isLoading=!1,this.provideMockAreas()}})}shouldUseMockData(){return!1}provideMockAreas(){this.areas=[{id:"area1",name:"Main Reception",location:"Building A",description:"Front reception area",screenCount:2,status:"active",lastUpdated:new Date,stats:{onlineScreens:2,totalScreens:2,activePlaylist:"Welcome Content",uptime:"99.9%",lastUpdated:new Date().toISOString()},screens:[]},{id:"area2",name:"Cafeteria",location:"Building B",description:"Main dining area",screenCount:3,status:"active",lastUpdated:new Date,stats:{onlineScreens:2,totalScreens:3,activePlaylist:"Food Specials",uptime:"98.5%",lastUpdated:new Date().toISOString()},screens:[]},{id:"area3",name:"Conference Room",location:"Building A",description:"Main conference room",screenCount:1,status:"active",lastUpdated:new Date,stats:{onlineScreens:1,totalScreens:1,activePlaylist:"Corporate Info",uptime:"100%",lastUpdated:new Date().toISOString()},screens:[]}],this.isLoading=!1,this.errorMessage=null,console.log("Using mock area data:",this.areas)}retryLoadAreas(){this.loadAreas()}verifyCode(){return P(this,null,function*(){if(this.codeForm.valid&&!this.isVerifying){this.isVerifying=!0;try{let e=this.codeForm.get("code")?.value,o=!1,i=null;try{let{data:c,error:m}=yield R.from("pending_registrations").select("*").eq("registration_code",e).eq("is_claimed",!1).single();!m&&c&&(o=!0,i=c.device_info)}catch(c){console.warn("Error checking registration code, using mock validation:",c),o=e.length===6&&/^\d+$/.test(e),i={userAgent:"Mozilla/5.0 (Mock Device)",resolution:"1920x1080",name:"Test Device",orientation:"landscape"}}if(o)this.detectedDevice={model:i?.userAgent?.split(")")[0]||"Unknown Device",resolution:i?.resolution||"1920x1080",serialNumber:"SN"+Math.random().toString(36).substr(2,9)},i?.name&&this.screenForm.get("name")?.setValue(i.name),i?.orientation&&this.screenForm.get("orientation")?.setValue(i.orientation),this.currentStep=1;else throw new Error("Invalid registration code or already claimed")}catch(e){console.error("Error verifying code:",e),this.errorMessage=e.message||"Failed to verify registration code"}finally{this.isVerifying=!1}}})}goToReview(){this.screenForm.valid&&(this.currentStep=2)}getInputClass(e,o){let i=e.get(o);return i?i.invalid&&(i.dirty||i.touched)?"bg-red-50 border-red-300 focus:ring-red-100":i.valid&&i.dirty?"bg-green-50 border-green-300 focus:ring-green-100":"bg-gray-50 border-gray-200 focus:ring-blue-100":"bg-gray-50"}shouldShowError(e,o){let i=e.get(o);return i?i.invalid&&(i.dirty||i.touched):!1}getAreaName(e){let o=this.areas.find(i=>i.id===e);return o?o.name:"Unknown Area"}handleSubmit(){if(this.screenForm.valid){let e=this.screenForm.value,o=this.areas.find(m=>m.id===e.area_id);if(!o){console.error("Selected area not found"),this.errorMessage="Selected area not found. Please try again.";return}let i={name:e.name,area_id:e.area_id,channel_id:o.id,channel_name:o.name,status:"offline",resolution:this.detectedDevice?.resolution||"1920x1080",orientation:e.orientation,last_ping:new Date().toISOString(),current_playlist:null,current_playlist_started_at:null,next_playlist:null,schedule:{upcoming:[],current:null},location:{building:o.location||"Unknown Building",floor:"1st Floor",room:"Main Room",area:"General Area"},hardware:{model:this.detectedDevice?.model||"Generic Display",manufacturer:"Generic",serial_number:this.detectedDevice?.serialNumber||`SN${Date.now()}`,display_size:'55"',brightness_level:100,contrast_ratio:"1000:1",supported_resolutions:[this.detectedDevice?.resolution||"1920x1080"],operating_hours:0},network:{ip_address:"192.168.1.100",mac_address:"00:00:00:00:00:00",connection_type:"ethernet",subnet:"255.255.255.0",gateway:"192.168.1.1",dns:["8.8.8.8","8.8.4.4"],last_config_update:new Date().toISOString()},settings:{auto_start:!0,auto_update:!0,remote_control:!0,power_schedule:{enabled:!0,power_on:"08:00",power_off:"20:00",days_active:["Monday","Tuesday","Wednesday","Thursday","Friday"]},content_caching:!0,fallback_content:"",refresh_interval:5,screen_rotation:0},analytics:{uptime:100,last_reboot:new Date().toISOString(),average_playback_time:0,errors:{count:0,last_error:"",error_history:[]},performance:{cpu_usage:0,memory_usage:0,storage_usage:0,temperature:25}},maintenance:{last_maintenance:new Date().toISOString(),next_scheduled_maintenance:new Date(Date.now()+30*24*60*60*1e3).toISOString(),maintenance_history:[],warranties:{status:"active",expiration_date:new Date(Date.now()+365*24*60*60*1e3).toISOString(),provider:"Manufacturer Warranty"}},tags:["new"]};console.log("Submitting screen data:",i);let c=this.codeForm.get("code")?.value;this.supabaseScreenService.createScreen(i,c).subscribe({next:m=>{console.log("Screen created successfully:",m),this.markRegistrationManually(c,m.id),this.onCreate.emit(i)},error:m=>{console.error("Error creating screen:",m),this.errorMessage="Failed to create screen: "+m.message,this.shouldUseMockData()&&(console.log("Emitting screen despite error (mock mode)"),this.onCreate.emit(i))}})}}markRegistrationManually(e,o){var i=R.from("pending_registrations").update({is_claimed:!0,device_id:o,claimed_at:new Date().toISOString()}).eq("registration_code",e).then(c=>{c.error?console.error("Error manually marking registration:",c.error):console.log("Registration manually marked as claimed successfully")});console.log("Data test"),console.log(i)}static{this.\u0275fac=function(o){return new(o||r)(w(Z),w(ne),w(ie))}}static{this.\u0275cmp=E({type:r,selectors:[["app-create-screen-dialog"]],outputs:{onCreate:"onCreate",onCancel:"onCancel"},standalone:!0,features:[M],decls:16,vars:4,consts:[[1,"fixed","inset-0","bg-black/30","backdrop-blur-sm","flex","items-center","justify-center","z-50"],[1,"bg-white","rounded-xl","shadow-2xl","max-w-2xl","w-full","mx-4"],[1,"border-b","border-gray-100","px-6","py-4"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-semibold","text-gray-900"],[1,"p-2","hover:bg-gray-100","rounded-full","transition-colors",3,"click"],[1,"material-icons","text-gray-500"],[1,"flex","gap-2"],[1,"flex-1"],[1,"p-6"],[1,"max-w-md","mx-auto"],[1,"space-y-6"],[1,"flex","items-center"],[1,"w-8","h-8","rounded-full","flex","items-center","justify-center",3,"ngClass"],[1,"material-icons","text-sm"],[1,"h-0.5","flex-1","mx-2",3,"ngClass"],[1,"text-sm","mt-2","text-gray-600"],[1,"text-center","mb-8"],[1,"w-20","h-20","bg-blue-50","rounded-2xl","flex","items-center","justify-center","mx-auto","mb-4"],[1,"material-icons","text-4xl","text-blue-500"],[1,"text-gray-600"],[1,"space-y-6",3,"ngSubmit","formGroup"],["type","text","formControlName","code","maxlength","6","placeholder","000000",1,"w-full","text-center","text-3xl","tracking-[0.5em]","py-4","rounded-lg","border","focus:ring-2","transition-all",3,"ngClass"],[1,"text-sm","text-red-500"],[1,"bg-red-50","p-3","rounded-lg","text-sm","text-red-600","mb-3"],["type","submit",1,"w-full","py-3","bg-blue-500","text-white","rounded-lg","disabled:opacity-50","disabled:cursor-not-allowed","hover:bg-blue-600","transition-colors",3,"disabled"],[1,"flex","items-center","justify-center"],[1,"material-icons","animate-spin","mr-2"],[1,"space-y-4",3,"formGroup"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","formControlName","name","placeholder","Enter screen name",1,"w-full","p-2.5","rounded-lg","border","focus:ring-2","transition-all"],[1,"text-sm","text-red-500","mt-1"],[1,"w-full","h-10","bg-gray-100","rounded-lg","animate-pulse"],[1,"space-y-2"],["formControlName","orientation",1,"w-full","p-2.5","rounded-lg","border","focus:ring-2","transition-all"],["value","landscape"],["value","portrait"],[1,"flex","justify-end","space-x-3","pt-4"],[1,"px-4","py-2","text-gray-600","hover:bg-gray-50","rounded-lg","transition-colors",3,"click"],[1,"px-4","py-2","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],["formControlName","area_id",1,"w-full","p-2.5","rounded-lg","border","border-red-300","focus:ring-2","focus:ring-red-100","transition-all"],["value",""],[1,"text-sm","text-red-500","flex","items-center"],[1,"material-icons","text-sm","mr-1"],["type","button",1,"text-blue-600","text-sm","hover:text-blue-700","flex","items-center",3,"click"],["formControlName","area_id",1,"w-full","p-2.5","rounded-lg","border","focus:ring-2","transition-all"],[1,"text-sm","text-gray-500"],["formControlName","area_id",1,"w-full","p-2.5","rounded-lg","border","focus:ring-2","transition-all",3,"ngClass"],[3,"value"],[1,"bg-gray-50","rounded-lg","p-6"],[1,"text-lg","font-medium","text-gray-900","mb-4"],[1,"grid","grid-cols-2","gap-4"],[1,"text-sm","font-medium","text-gray-900"],[1,"bg-red-50","p-4","rounded-lg","text-sm","text-red-600"],[1,"flex","justify-end","space-x-3"],[1,"px-4","py-2","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600","transition-colors",3,"click"]],template:function(o,i){o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),a(5),t(),n(6,"button",5),p("click",function(){return i.onCancel.emit()}),n(7,"span",6),a(8,"close"),t()()(),n(9,"div",7),b(10,he,8,8,"div",8,$),t()(),n(12,"div",9),f(13,Ee,14,6,"div",10)(14,Ae,27,4,"div",11)(15,Oe,31,5,"div",11),t()()()),o&2&&(l(5),S(i.steps[i.currentStep].title),l(5),y(i.steps),l(3),u(i.currentStep===0?13:-1),l(),u(i.currentStep===1?14:-1),l(),u(i.currentStep===2?15:-1))},dependencies:[T,A,te,J,L,j,N,B,O,Q,Y,K,X],encapsulation:2})}}return r})();var ce=(r,s)=>s.id;function Be(r,s){if(r&1&&(n(0,"option",31),a(1),t()),r&2){let e=s.$implicit;x("value",e.id),l(),S(e.name)}}function Le(r,s){r&1&&(n(0,"div",41),v(1,"div",43),t())}function je(r,s){r&1&&(n(0,"div",42)(1,"span",44),a(2,"search_off"),t(),n(3,"h3",45),a(4,"No screens found"),t(),n(5,"p",46),a(6,"Try adjusting your search criteria"),t()())}function Re(r,s){if(r&1){let e=h();n(0,"app-screen-card",50),p("edit",function(i){g(e);let c=d(3);return _(c.editScreen(i))})("viewDetails",function(i){g(e);let c=d(3);return _(c.viewScreenDetails(i))}),t()}if(r&2){let e=s.$implicit;x("screen",e)}}function Pe(r,s){if(r&1&&(n(0,"div",47),b(1,Re,1,1,"app-screen-card",49,ce),t()),r&2){let e=d(2);l(),y(e.filteredScreens)}}function Ue(r,s){if(r&1){let e=h();n(0,"div",48)(1,"app-screen-table",51),p("edit",function(i){g(e);let c=d(2);return _(c.editScreen(i))}),t()()}if(r&2){let e=d(2);l(),x("screens",e.filteredScreens)}}function $e(r,s){if(r&1&&f(0,Pe,3,0,"div",47)(1,Ue,2,1,"div",48),r&2){let e=d();u(e.viewMode==="grid"?0:1)}}function We(r,s){if(r&1){let e=h();n(0,"app-create-screen-dialog",52),p("onCreate",function(i){g(e);let c=d();return _(c.handleCreateScreen(i))})("onCancel",function(){g(e);let i=d();return _(i.closeCreateDialog())}),t()}}var ut=(()=>{class r{constructor(e,o){this.screenService=e,this.router=o,this.screens=[],this.filteredScreens=[],this.loading=!0,this.viewMode="grid",this.searchQuery="",this.showCreateDialog=!1,this.selectedScreen=null,this.channels=[{id:"ch1",name:"Main Channel"},{id:"ch2",name:"Secondary Channel"}],this.areas=[{id:"area1",name:"Main Area"},{id:"area2",name:"Secondary Area"}],this.filters={areaId:"",status:""}}ngOnInit(){this.loadScreens()}get screensByStatus(){return{total:this.screens.length,online:this.screens.filter(e=>e.status==="online").length,offline:this.screens.filter(e=>e.status==="offline").length,maintenance:this.screens.filter(e=>e.status==="maintenance").length,error:this.screens.filter(e=>e.status==="error").length}}loadScreens(){this.loading=!0,this.screenService.getScreens().subscribe({next:e=>{this.screens=e,this.applyFilters(),this.loading=!1},error:e=>{console.error("Error loading screens:",e),this.loading=!1}})}applyFilters(){let e=this.searchQuery.toLowerCase();this.filteredScreens=this.screens.filter(o=>{let i=!e||o.name.toLowerCase().includes(e)||o.channel_name.toLowerCase().includes(e),c=!this.filters.areaId||o.area_id===this.filters.areaId,m=!this.filters.status||o.status===this.filters.status;return i&&c&&m})}openCreateDialog(){this.showCreateDialog=!0}closeCreateDialog(){this.showCreateDialog=!1}handleCreateScreen(e){this.screenService.createScreen(e).subscribe({next:o=>{this.screens=[...this.screens,o],this.applyFilters(),this.closeCreateDialog()},error:o=>{console.error("Error creating screen:",o)}})}editScreen(e){console.log("Edit screen:",e)}viewScreenDetails(e){this.router.navigate(["/screens",e.id])}confirmDelete(e){confirm(`Are you sure you want to delete ${e.name}?`)&&this.screenService.deleteScreen(e.id).subscribe({next:()=>{this.screens=this.screens.filter(o=>o.id!==e.id),this.applyFilters()},error:o=>{console.error("Error deleting screen:",o)}})}static{this.\u0275fac=function(o){return new(o||r)(w(re),w(z))}}static{this.\u0275cmp=E({type:r,selectors:[["app-screens"]],standalone:!0,features:[M],decls:96,vars:11,consts:[[1,"min-h-screen","bg-gray-50"],[1,"max-w-7xl","mx-auto","bg-white","rounded-xl","shadow-sm","p-6","mb-6"],[1,"flex","flex-col","md:flex-row","justify-between","items-start","md:items-center","gap-4"],[1,"text-2xl","font-semibold","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"flex","flex-col","sm:flex-row","w-full","md:w-auto","gap-3"],[1,"relative","flex-grow","sm:max-w-xs"],["type","text","placeholder","Search screens...",1,"w-full","pl-10","pr-4","py-2","border","border-gray-200","rounded-lg","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-100","focus:border-blue-200","transition-colors",3,"ngModelChange","ngModel"],[1,"material-icons","absolute","left-3","top-2.5","text-gray-400","text-sm"],[1,"flex","items-center","justify-center","px-4","py-2","bg-blue-50","text-blue-600","rounded-lg","hover:bg-blue-100","transition-colors","text-sm","font-medium","shadow-lg",3,"click"],[1,"material-icons","text-sm","mr-2"],[1,"max-w-7xl","mx-auto","grid","grid-cols-1","md:grid-cols-4","gap-4","mb-6"],[1,"bg-white","rounded-xl","p-6","shadow-sm"],[1,"flex","items-center","gap-4"],[1,"p-3","bg-blue-50","rounded-lg"],[1,"material-icons","text-blue-600"],[1,"text-sm","text-gray-500"],[1,"text-2xl","font-semibold"],[1,"p-3","bg-green-50","rounded-lg"],[1,"material-icons","text-green-600"],[1,"p-3","bg-gray-50","rounded-lg"],[1,"material-icons","text-gray-600"],[1,"p-3","bg-amber-50","rounded-lg"],[1,"material-icons","text-amber-600"],[1,"max-w-7xl","mx-auto","mb-6"],[1,"bg-white","rounded-xl","p-4","shadow-sm"],[1,"flex","flex-wrap","gap-4"],[1,"flex-grow","min-w-[200px]"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"w-full","px-3","py-2","border","border-gray-200","rounded-lg","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-100",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["value","online"],["value","offline"],["value","maintenance"],["value","error"],[1,"flex","items-end"],[1,"flex","bg-gray-50","rounded-lg","p-1"],[1,"p-2","rounded-lg","transition-colors",3,"click","ngClass"],[1,"material-icons"],[1,"max-w-7xl","mx-auto"],[1,"flex","justify-center","items-center","py-12"],[1,"bg-white","rounded-xl","p-8","text-center","shadow-sm"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],[1,"material-icons","text-gray-400","text-4xl","mb-2"],[1,"text-lg","font-medium","text-gray-900","mb-1"],[1,"text-gray-500"],[1,"grid","grid-cols-1","md:grid-cols-2","xl:grid-cols-3","gap-4"],[1,"bg-white","rounded-xl","shadow-sm","overflow-hidden"],[3,"screen"],[3,"edit","viewDetails","screen"],[3,"edit","screens"],[3,"onCreate","onCancel"]],template:function(o,i){o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),a(5,"Screens"),t(),n(6,"p",4),a(7,"Manage your display devices"),t()(),n(8,"div",5)(9,"div",6)(10,"input",7),V("ngModelChange",function(m){return I(i.searchQuery,m)||(i.searchQuery=m),m}),t(),n(11,"span",8),a(12,"search"),t()(),n(13,"button",9),p("click",function(){return i.openCreateDialog()}),n(14,"span",10),a(15,"add"),t(),a(16," Add Screen "),t()()()(),n(17,"div",11)(18,"div",12)(19,"div",13)(20,"div",14)(21,"span",15),a(22,"devices"),t()(),n(23,"div")(24,"p",16),a(25,"Total Screens"),t(),n(26,"p",17),a(27),t()()()(),n(28,"div",12)(29,"div",13)(30,"div",18)(31,"span",19),a(32,"wifi"),t()(),n(33,"div")(34,"p",16),a(35,"Online"),t(),n(36,"p",17),a(37),t()()()(),n(38,"div",12)(39,"div",13)(40,"div",20)(41,"span",21),a(42,"wifi_off"),t()(),n(43,"div")(44,"p",16),a(45,"Offline"),t(),n(46,"p",17),a(47),t()()()(),n(48,"div",12)(49,"div",13)(50,"div",22)(51,"span",23),a(52,"build"),t()(),n(53,"div")(54,"p",16),a(55,"Maintenance"),t(),n(56,"p",17),a(57),t()()()()(),n(58,"div",24)(59,"div",25)(60,"div",26)(61,"div",27)(62,"label",28),a(63,"Area"),t(),n(64,"select",29),V("ngModelChange",function(m){return I(i.filters.areaId,m)||(i.filters.areaId=m),m}),n(65,"option",30),a(66,"All Areas"),t(),b(67,Be,2,2,"option",31,ce),t()(),n(69,"div",27)(70,"label",28),a(71,"Status"),t(),n(72,"select",29),V("ngModelChange",function(m){return I(i.filters.status,m)||(i.filters.status=m),m}),n(73,"option",30),a(74,"All Statuses"),t(),n(75,"option",32),a(76,"Online"),t(),n(77,"option",33),a(78,"Offline"),t(),n(79,"option",34),a(80,"Maintenance"),t(),n(81,"option",35),a(82,"Error"),t()()(),n(83,"div",36)(84,"div",37)(85,"button",38),p("click",function(){return i.viewMode="grid"}),n(86,"span",39),a(87,"grid_view"),t()(),n(88,"button",38),p("click",function(){return i.viewMode="list"}),n(89,"span",39),a(90,"view_list"),t()()()()()()(),n(91,"div",40),f(92,Le,2,0,"div",41)(93,je,7,0,"div",42)(94,$e,2,1),t(),f(95,We,1,0,"app-create-screen-dialog"),t()),o&2&&(l(10),F("ngModel",i.searchQuery),l(17),S(i.screensByStatus.total),l(10),S(i.screensByStatus.online),l(10),S(i.screensByStatus.offline),l(10),S(i.screensByStatus.maintenance),l(7),F("ngModel",i.filters.areaId),l(3),y(i.areas),l(5),F("ngModel",i.filters.status),l(13),x("ngClass",i.viewMode==="grid"?"bg-white text-blue-600 shadow-sm":"text-gray-500"),l(3),x("ngClass",i.viewMode==="list"?"bg-white text-blue-600 shadow-sm":"text-gray-500"),l(4),u(i.loading?92:i.filteredScreens.length===0?93:94),l(3),u(i.showCreateDialog?95:-1))},dependencies:[T,A,ee,L,j,N,B,O,H,ae,le,se],encapsulation:2})}}return r})();export{ut as ScreensComponent};
